<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lumera Token Scheduler - dApp</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'pulse': 'pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #1e1b4b 0%, #312e81 25%, #3730a3 50%, #1e40af 75%, #1e3a8a 100%);
        }
        
        .glass {
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
        }
        
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
        
        .hover-scale:hover {
            transform: scale(1.05);
        }
        
        .transition-all {
            transition: all 0.3s ease;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide Icons as SVG components
        const WalletIcon = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"/>
                <path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"/>
            </svg>
        );

        const SendIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m22 2-7 20-4-9-9-4Z"/>
                <path d="M22 2 11 13"/>
            </svg>
        );

        const ClockIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"/>
                <polyline points="12,6 12,12 16,14"/>
            </svg>
        );

        const HistoryIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
                <path d="M3 3v5h5"/>
                <path d="M12 7v5l4 2"/>
            </svg>
        );

        const ZapIcon = () => (
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="13,2 3,14 12,14 11,22 21,10 12,10 13,2"/>
            </svg>
        );

        const CalendarIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M8 2v4"/>
                <path d="M16 2v4"/>
                <rect width="18" height="18" x="3" y="4" rx="2"/>
                <path d="M3 10h18"/>
            </svg>
        );

        const ShieldIcon = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"/>
            </svg>
        );

        const ExternalLinkIcon = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M15 3h6v6"/>
                <path d="M10 14 21 3"/>
                <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
            </svg>
        );

        const LumeraTokenScheduler = () => {
            const [isConnected, setIsConnected] = useState(false);
            const [walletAddress, setWalletAddress] = useState('');
            const [balance, setBalance] = useState('0');
            const [activeTab, setActiveTab] = useState('send');
            const [scheduledTxs, setScheduledTxs] = useState([]);
            const [history, setHistory] = useState([]);

            // Form states
            const [recipientAddress, setRecipientAddress] = useState('');
            const [amount, setAmount] = useState('');
            const [scheduleDate, setScheduleDate] = useState('');
            const [scheduleTime, setScheduleTime] = useState('');
            const [note, setNote] = useState('');

            const LUMERA_CHAIN_CONFIG = {
                chainId: 'lumera-testnet-2',
                chainName: 'Lumera Testnet',
                rpc: 'https://lumera-testnet-rpc.linknode.org/',
                rest: 'https://lumera-testnet-api.linknode.org/',
                bech32Config: {
                    bech32PrefixAccAddr: 'lumera',
                    bech32PrefixAccPub: 'lumerapub',
                    bech32PrefixValAddr: 'lumeravaloper',
                    bech32PrefixValPub: 'lumeravaloperpub',
                    bech32PrefixConsAddr: 'lumeravalcons',
                    bech32PrefixConsPub: 'lumeravalconspub',
                },
                currencies: [{
                    coinDenom: 'LUME',
                    coinMinimalDenom: 'ulume',
                    coinDecimals: 6,
                }],
                feeCurrencies: [{
                    coinDenom: 'LUME',
                    coinMinimalDenom: 'ulume',
                    coinDecimals: 6,
                }],
                stakeCurrency: {
                    coinDenom: 'LUME',
                    coinMinimalDenom: 'ulume',
                    coinDecimals: 6,
                },
            };

            const connectKeplr = async () => {
                if (!window.keplr) {
                    alert('Please install Keplr extension first!');
                    window.open('https://www.keplr.app/', '_blank');
                    return;
                }

                try {
                    await window.keplr.experimentalSuggestChain(LUMERA_CHAIN_CONFIG);
                    await window.keplr.enable('lumera-testnet-2');
                    
                    const offlineSigner = window.keplr.getOfflineSigner('lumera-testnet-2');
                    const accounts = await offlineSigner.getAccounts();
                    
                    setWalletAddress(accounts[0].address);
                    setIsConnected(true);
                    
                    // Simulate getting balance
                    fetchBalance(accounts[0].address);
                } catch (error) {
                    console.error('Failed to connect Keplr:', error);
                    alert('Failed to connect wallet. Please try again.');
                }
            };

            const fetchBalance = async (address) => {
                try {
                    const response = await fetch(`${LUMERA_CHAIN_CONFIG.rest}/cosmos/bank/v1beta1/balances/${address}`);
                    const data = await response.json();
                    
                    const lumeBalance = data.balances?.find(coin => coin.denom === 'ulume');
                    if (lumeBalance) {
                        const formattedBalance = (parseInt(lumeBalance.amount) / 1000000).toFixed(6);
                        setBalance(formattedBalance);
                    }
                } catch (error) {
                    console.error('Failed to fetch balance:', error);
                    // Set demo balance for testing
                    setBalance('100.000000');
                }
            };

            const scheduleTransaction = () => {
                if (!recipientAddress || !amount || !scheduleDate || !scheduleTime) {
                    alert('Please fill all required fields');
                    return;
                }

                const scheduledDateTime = new Date(`${scheduleDate}T${scheduleTime}`);
                const now = new Date();
                
                if (scheduledDateTime <= now) {
                    alert('Please select a future date and time');
                    return;
                }

                const newScheduledTx = {
                    id: Date.now(),
                    recipient: recipientAddress,
                    amount: amount,
                    scheduledTime: scheduledDateTime,
                    note: note,
                    status: 'pending',
                    created: now
                };

                setScheduledTxs([...scheduledTxs, newScheduledTx]);
                
                // Clear form
                setRecipientAddress('');
                setAmount('');
                setScheduleDate('');
                setScheduleTime('');
                setNote('');
                
                alert('Transaction scheduled successfully!');
            };

            const executeScheduledTx = (txId) => {
                const tx = scheduledTxs.find(t => t.id === txId);
                if (!tx) return;

                // Simulate transaction execution
                const executedTx = {
                    ...tx,
                    status: 'completed',
                    txHash: '0x' + Math.random().toString(16).substr(2, 64),
                    executedAt: new Date()
                };

                setHistory([executedTx, ...history]);
                setScheduledTxs(scheduledTxs.filter(t => t.id !== txId));
                
                alert(`Transaction executed! Hash: ${executedTx.txHash.substr(0, 16)}...`);
            };

            const cancelScheduledTx = (txId) => {
                setScheduledTxs(scheduledTxs.filter(t => t.id !== txId));
                alert('Scheduled transaction cancelled');
            };

            const formatAddress = (address) => {
                if (!address) return '';
                return `${address.substr(0, 8)}...${address.substr(-8)}`;
            };

            const formatDate = (date) => {
                return new Intl.DateTimeFormat('id-ID', {
                    dateStyle: 'short',
                    timeStyle: 'short'
                }).format(new Date(date));
            };

            return (
                <div className="min-h-screen gradient-bg">
                    {/* Hero Section */}
                    <div className="relative overflow-hidden">
                        <div className="absolute inset-0 bg-black opacity-20"></div>
                        <div className="relative z-10 px-6 py-12">
                            <div className="max-w-6xl mx-auto text-center">
                                <div className="flex justify-center mb-6">
                                    <div className="bg-gradient-to-r from-pink-500 to-violet-500 p-4 rounded-full">
                                        <ZapIcon />
                                    </div>
                                </div>
                                <h1 className="text-5xl font-bold text-white mb-4 bg-gradient-to-r from-pink-400 to-violet-400 bg-clip-text text-transparent">
                                    Lumera Token Scheduler
                                </h1>
                                <p className="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
                                    Schedule your LUME token transfers with precision. Built for the Lumera Testnet ecosystem with modern UI and powerful features.
                                </p>
                                
                                {!isConnected ? (
                                    <button
                                        onClick={connectKeplr}
                                        className="bg-gradient-to-r from-pink-500 to-violet-500 hover:from-pink-600 hover:to-violet-600 text-white px-8 py-4 rounded-xl font-semibold transition-all duration-300 hover-scale shadow-lg flex items-center gap-3 mx-auto"
                                    >
                                        <WalletIcon />
                                        Connect Keplr Wallet
                                    </button>
                                ) : (
                                    <div className="bg-white/10 glass rounded-2xl p-6 max-w-md mx-auto border border-white/20">
                                        <div className="flex items-center gap-3 mb-4">
                                            <div className="w-3 h-3 bg-green-500 rounded-full animate-pulse"></div>
                                            <span className="text-white font-medium">Connected</span>
                                        </div>
                                        <div className="text-gray-300 mb-2">Address: {formatAddress(walletAddress)}</div>
                                        <div className="text-2xl font-bold text-white">{balance} LUME</div>
                                    </div>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Main App */}
                    {isConnected && (
                        <div className="max-w-6xl mx-auto px-6 py-8">
                            {/* Tab Navigation */}
                            <div className="bg-white/10 glass rounded-2xl p-2 mb-8 border border-white/20">
                                <div className="flex gap-2">
                                    {[
                                        { id: 'send', label: 'Schedule Transfer', icon: SendIcon },
                                        { id: 'scheduled', label: 'Scheduled Txs', icon: ClockIcon },
                                        { id: 'history', label: 'History', icon: HistoryIcon }
                                    ].map(tab => {
                                        const IconComponent = tab.icon;
                                        return (
                                            <button
                                                key={tab.id}
                                                onClick={() => setActiveTab(tab.id)}
                                                className={`flex-1 flex items-center justify-center gap-2 py-3 px-4 rounded-xl font-medium transition-all duration-300 ${
                                                    activeTab === tab.id
                                                        ? 'bg-gradient-to-r from-pink-500 to-violet-500 text-white shadow-lg'
                                                        : 'text-gray-300 hover:text-white hover:bg-white/10'
                                                }`}
                                            >
                                                <IconComponent />
                                                {tab.label}
                                            </button>
                                        );
                                    })}
                                </div>
                            </div>

                            {/* Tab Content */}
                            <div className="bg-white/10 glass rounded-2xl p-8 border border-white/20">
                                {activeTab === 'send' && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                                            <SendIcon />
                                            Schedule Token Transfer
                                        </h2>
                                        
                                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                            <div>
                                                <label className="block text-gray-300 mb-2">Recipient Address</label>
                                                <input
                                                    type="text"
                                                    value={recipientAddress}
                                                    onChange={(e) => setRecipientAddress(e.target.value)}
                                                    placeholder="lumera1..."
                                                    className="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 transition-all"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-gray-300 mb-2">Amount (LUME)</label>
                                                <input
                                                    type="number"
                                                    value={amount}
                                                    onChange={(e) => setAmount(e.target.value)}
                                                    placeholder="0.000000"
                                                    step="0.000001"
                                                    className="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 transition-all"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-gray-300 mb-2">Schedule Date</label>
                                                <input
                                                    type="date"
                                                    value={scheduleDate}
                                                    onChange={(e) => setScheduleDate(e.target.value)}
                                                    className="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-pink-500 transition-all"
                                                />
                                            </div>
                                            
                                            <div>
                                                <label className="block text-gray-300 mb-2">Schedule Time</label>
                                                <input
                                                    type="time"
                                                    value={scheduleTime}
                                                    onChange={(e) => setScheduleTime(e.target.value)}
                                                    className="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-pink-500 transition-all"
                                                />
                                            </div>
                                        </div>
                                        
                                        <div>
                                            <label className="block text-gray-300 mb-2">Note (Optional)</label>
                                            <textarea
                                                value={note}
                                                onChange={(e) => setNote(e.target.value)}
                                                placeholder="Add a note for this transaction..."
                                                rows="3"
                                                className="w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-pink-500 transition-all resize-none"
                                            />
                                        </div>
                                        
                                        <button
                                            onClick={scheduleTransaction}
                                            className="w-full bg-gradient-to-r from-pink-500 to-violet-500 hover:from-pink-600 hover:to-violet-600 text-white py-4 rounded-xl font-semibold transition-all duration-300 hover-scale shadow-lg flex items-center justify-center gap-3"
                                        >
                                            <CalendarIcon />
                                            Schedule Transaction
                                        </button>
                                    </div>
                                )}

                                {activeTab === 'scheduled' && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                                            <ClockIcon />
                                            Scheduled Transactions ({scheduledTxs.length})
                                        </h2>
                                        
                                        {scheduledTxs.length === 0 ? (
                                            <div className="text-center py-12">
                                                <ClockIcon />
                                                <p className="text-gray-400 text-lg mt-4">No scheduled transactions</p>
                                            </div>
                                        ) : (
                                            <div className="space-y-4">
                                                {scheduledTxs.map(tx => (
                                                    <div key={tx.id} className="bg-white/5 border border-white/20 rounded-xl p-6">
                                                        <div className="flex justify-between items-start mb-4">
                                                            <div>
                                                                <div className="text-white font-semibold mb-1">
                                                                    {tx.amount} LUME → {formatAddress(tx.recipient)}
                                                                </div>
                                                                <div className="text-gray-400 text-sm">
                                                                    Scheduled: {formatDate(tx.scheduledTime)}
                                                                </div>
                                                                {tx.note && (
                                                                    <div className="text-gray-300 text-sm mt-2 italic">"{tx.note}"</div>
                                                                )}
                                                            </div>
                                                            <div className="flex gap-2">
                                                                <button
                                                                    onClick={() => executeScheduledTx(tx.id)}
                                                                    className="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm transition-all"
                                                                >
                                                                    Execute
                                                                </button>
                                                                <button
                                                                    onClick={() => cancelScheduledTx(tx.id)}
                                                                    className="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg text-sm transition-all"
                                                                >
                                                                    Cancel
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}

                                {activeTab === 'history' && (
                                    <div className="space-y-6">
                                        <h2 className="text-2xl font-bold text-white mb-6 flex items-center gap-3">
                                            <HistoryIcon />
                                            Transaction History ({history.length})
                                        </h2>
                                        
                                        {history.length === 0 ? (
                                            <div className="text-center py-12">
                                                <HistoryIcon />
                                                <p className="text-gray-400 text-lg mt-4">No transaction history</p>
                                            </div>
                                        ) : (
                                            <div className="space-y-4">
                                                {history.map(tx => (
                                                    <div key={tx.id} className="bg-white/5 border border-white/20 rounded-xl p-6">
                                                        <div className="flex justify-between items-start">
                                                            <div>
                                                                <div className="text-white font-semibold mb-1">
                                                                    {tx.amount} LUME → {formatAddress(tx.recipient)}
                                                                </div>
                                                                <div className="text-gray-400 text-sm">
                                                                    Executed: {formatDate(tx.executedAt)}
                                                                </div>
                                                                <div className="text-gray-400 text-sm">
                                                                    Hash: {formatAddress(tx.txHash)}
                                                                </div>
                                                                {tx.note && (
                                                                    <div className="text-gray-300 text-sm mt-2 italic">"{tx.note}"</div>
                                                                )}
                                                            </div>
                                                            <div className="flex items-center gap-2">
                                                                <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                                                                <span className="text-green-400 text-sm">Completed</span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                )}
                            </div>

                            {/* Footer Info */}
                            <div className="mt-8 bg-white/5 glass rounded-2xl p-6 border border-white/20">
                                <div className="text-center">
                                    <h3 className="text-xl font-bold text-white mb-4 flex items-center justify-center gap-2">
                                        <ShieldIcon />
                                        Lumera Testnet Info
                                    </h3>
                                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                                        <div>
                                            <div className="text-gray-400">Chain ID</div>
                                            <div className="text-white font-mono">lumera-testnet-2</div>
                                        </div>
                                        <div>
                                            <div className="text-gray-400">Token</div>
                                            <div className="text-white">LUME</div>
                                        </div>
                                        <div>
                                            <div className="text-gray-400">Decimals</div>
                                            <div className="text-white">6</div>
                                        </div>
                                    </div>
                                    <div className="mt-4 flex justify-center gap-4">
                                        <a 
                                            href="https://faucet-lumera.winnode.xyz/" 
                                            target="_blank" 
                                            rel="noopener noreferrer"
                                            className="text-pink-400 hover:text-pink-300 transition-all flex items-center gap-1"
                                        >
                                            Get Testnet Tokens <ExternalLinkIcon />
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<LumeraTokenScheduler />, document.getElementById('root'));
    </script>
</body>
</html>
